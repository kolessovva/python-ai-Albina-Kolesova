# Правила для поиска идей визуализации на основе данных Викиданных
# Rules for Finding Visualization Ideas from Wikidata

***

## Назначение файла

Этот файл — методические правила для систематического поиска идей визуализации
в лабораторной работе 3 курса «Python + AI» (ПетрГУ, 2026).

Правила помогают не генерировать идеи наугад, а системно исследовать
потенциал конкретного датасета.

Смежные файлы:
- task_1_sparql_guide.txt — требования к SPARQL-запросам (задание 1)
- task_2_requirements.txt — требования к ноутбуку (задание 2)

***

Правило 1. Инвентаризация полей перед генерацией идей.
Для каждого поля датасета явно определи: тип (категориальное / числовое /
текстовое / булево), заполненность (% непустых значений), мощность (сколько
уникальных значений). Разреженные поля (заполнены менее чем на 10–15%) —
не отбрасывать: именно они часто несут самый интересный сигнал
(«что объединяет эти редкие записи?»).

***

Правило 2. Матрица пар полей.
Для каждой пары полей задай вопрос: «есть ли между ними интересная зависимость?»
Систематически пройди все пары: страна × рейтинг, страна × тип объекта,
тип × год постройки, год × охранный статус и т.д.
Чем больше полей в датасете, тем богаче пространство гипотез.

***

Правило 3. Отношения «многие ко многим» → граф.
Если два объекта связаны через третий (страна — памятник — страна архитектора;
город — памятник — тип), это сигнал к построению сетевого графа.
Граф выявляет кластеры, хабы и мосты, которые никакой другой тип
визуализации не покажет.

Отдельный случай — связь через человека: если памятник → архитектор →
страна рождения архитектора, то страны оказываются связаны через архитекторов.
Это сигнал к построению двудольного графа «страна памятника — страна архитектора»,
который выявляет исторические потоки (например, итальянские архитекторы в России).

***

Правило 4. Иерархия сложности визуализаций.
Двигаться от простого к сложному, но предлагать оба конца шкалы:
- Простые (barchart, heatmap) — быстрый результат, легко объяснить
- Средние (choropleth map, bubble chart, scatter plot, timeline / Gantt) —
  требуют подготовки данных
- Сложные (network graph, sankey diagram, bipartite graph, treemap) —
  оригинальны, впечатляют, но требуют нескольких итераций с AI

***

Правило 5. Каждая визуализация отвечает на конкретный вопрос.
Не «нарисуем барчарт по странам», а «в каких странах рейтинговая система
применяется, а в каких игнорируется?»
Формулировка вопроса помогает студенту понять, зачем строится именно
эта картинка.

***

Правило 6. Разреженные поля — не помеха, а материал для анализа.
Если поле заполнено редко (например, охранный статус — 8%,
архитекторы — 12%), это не повод его игнорировать.
Вопрос: «что общего у объектов с этим признаком?» часто даёт
самые неожиданные и интересные выводы.

***

Правило 7. Тройные связки — самый глубокий уровень.
После анализа пар полей искать тройки: страна + тип памятника + охранный статус,
архитектор + страна + тип постройки.
Тройные связки хорошо визуализируются через Sankey diagram или
трёхдольный граф. Это уровень «сильного» задания.

***

Правило 8. Учитывай специфику Викиданных.
Данные Викиданных всегда неполны и неравномерны: одни объекты описаны
подробно, другие — только QID без метки. Это не баг, а особенность.
Визуализация «насколько полно описаны объекты по полям» сама по себе
интересна и показывает тематические белые пятна в базе знаний.

***

Правило 9. Люди как связанный объект открывают отдельный класс визуализаций.
Свойства, связывающие объект с человеком (архитектор P84, основатель P112,
режиссёр P57, композитор P86 и т.п.), дают данные, недоступные при работе
только с основным объектом:
- Карты миграции: страна рождения → страна смерти
- Корреляция продолжительности жизни с типом создаваемых объектов
- География образования (в каких университетах учились)
- Гендерный анализ по эпохам или типам объектов

Для этого требуется отдельный SPARQL-файл (entity_architects.sparql или
entity_founders.sparql) и join в pandas по URI главного объекта.
Это уровень сложных визуализаций, но данные для него закладываются
уже в задании 1.

Отдельный подкласс — генеалогические визуализации (экспериментальный паттерн).
Для биологических объектов (животные, люди) свойства P22 (отец) и P25 (мать)
открывают новый уровень анализа:
- Дерево предков и потомков (networkx + graphviz)
- Передача породы через поколения (Sankey по поколениям)
- Поиск «основателей» породных линий (хабы в графе родословных)

Для этого требуется отдельный файл entity_genealogy.sparql и join
с основным датасетом по URI объекта (см. task_1_sparql_guide.txt, раздел A1).
Паттерн перспективный, но на практике до стадии визуализации
пока не проверен — возможны уточнения по мере накопления опыта.

***

Правило 10. CSV в «длинном формате» — не проблема, а ресурс.          # [NEW]
Если CSV содержит несколько строк на один объект из-за многозначного   # [NEW]
поля (жанры, соседи, архитекторы, языки и т.п.) — это не недостаток    # [NEW]
запроса, а дополнительная аналитическая возможность:                   # [NEW]
                                                                        # [NEW]
- Подсчёт уникальных значений поля: сколько раз встречается жанр /     # [NEW]
  страна / стиль — и сортировка по частоте (bar chart).                # [NEW]
- Совместная встречаемость: какие два значения чаще всего появляются    # [NEW]
  вместе (heatmap матрицы сo-occurrence).                               # [NEW]
- Граф совместной встречаемости: объекты как вершины, совпадающие       # [NEW]
  значения поля как рёбра (например, два объекта связаны, если у них    # [NEW]
  одинаковый жанр или общий сосед).                                     # [NEW]
                                                                        # [NEW]
Перед построением визуализации убедиться: df['URL'].nunique() ≪ len(df).# [NEW]
Если да — это «длинный формат»; схлопнуть данные через groupby + agg,  # [NEW]
прежде чем строить графики по объектам (иначе объекты с несколькими    # [NEW]
значениями окажутся представлены непропорционально).                    # [NEW]

***

Правило 11. Технологическая родословная → направленный граф.           # [NEW]
Если датасет содержит поле «на основе чего создан» (P144 based on),    # [NEW]
это сигнал к построению направленного ациклического графа (DAG):       # [NEW]
вершины — объекты, рёбра — отношение наследования технологии или идеи. # [NEW]
Такой граф выявляет «корневые» изобретения и показывает, как одна      # [NEW]
технология порождает семейство потомков. Строится через networkx.DiGraph.# [NEW]
Данные для него — в файле entity_lineage.sparql                        # [NEW]
(см. task_1_sparql_guide.txt, раздел A1).                               # [NEW]
